---
code: |
  if clientmessage.recipient == "client":
    clientmessage.toline = greeting(client, with_punctuation=False, language=client.language)
  elif clientmessage.recipient == "pbadvocate":
    if pbadvocate.gender == "male":
      pbadvocate.salutation_text = "Mr."
    elif pbadvocate.gender == "female":  
      pbadvocate.salutation_text = "Ms."
    else: 
      pbadvocate.salutation_text = pbadvocate.name.first
    clientmessage.toline = "Dear " + capitalize(pbadvocate.salutation_text) + " " + capitalize(pbadvocate.name.last)
---
code: |
  if clientmessage.recipient == "client":
    clientmessage.recipientname = client.name
  elif clientmessage.recipient == "pbadvocate":
    clientmessage.recipientname = pbadvocate.name
---
code: |
  if clientmessage.sender == "advocate":
    clientmessage.fromline = advocate.name 
  elif clientmessage.sender == "initiator":
    clientmessage.fromline =  initiator.name
---
code: | 
  if defined('ls_fields.legal_problem_code'):
    legal_problem_code_num = int(ls_fields.legal_problem_code[0:2])
    if defined('ls_fields.special_legal_problem_code'):
      if ls_fields.special_legal_problem_code[4] == " ":
        special_legal_problem_code_num = int(ls_fields.special_legal_problem_code[0:3])
      else:
        special_legal_problem_code_num = int(ls_fields.special_legal_problem_code[0:4])
      if ls_fields.special_legal_problem_code == "N/A":
        LPC = ls_fields.legal_problem_code
      else: 
        LPC = ls_fields.special_legal_problem_code
    else:
      LPC = ls_fields.legal_problem_code
  else:
    LPC = "Legal Problem Code"
---
code: | 
  if defined('pbadvocate.name.last'):
    the_pbadvocate = pbadvocate.name
  else:
    the_pbadvocate = "There is no Pro Bono Volunteer"
---
code: |
  if defined('ls_fields.casenumber'):
    casenumber = ls_fields.casenumber
---