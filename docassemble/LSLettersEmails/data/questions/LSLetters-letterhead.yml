---
question: |
  Letterhead
subquestion: |
  What letterhead do you want to use?
field: clientmessage.letterhead
choices: 
  - Default: default
    default: true
  - Advocate: letter_to_pbadvocate
  - Client: letter_to_client
---
code: |
  # this is for letters generated, printed, and saved in case file
  if clientmessage.letterhead == "default":
    if clientmessage.recipient == "client": 
      email_copy_sent_ok = send_email(to=LSCase, template=LetterGenerated, attachments=[letter_to_client.pdf, letter_to_client.docx])
    elif clientmessage.recipient == "pbadvocate": 
      email_copy_sent_ok = send_email(to=LSCase, template=LetterGenerated, attachments=[letter_to_pbadvocate.pdf, letter_to_pbadvocate.docx])
    elif clientmessage.recipient == "advocate":
      email_copy_sent_ok = send_email(to=LSCase, template=LetterGenerated, attachments=[letter_to_client.pdf, letter_to_client.docx])
  else:
    email_copy_sent_ok = send_email(to=LSCase, template=LetterGenerated, attachments=[clientmessage.letterhead.pdf, clientmessage.letterhead.docx])
  
---
attachment: 
  name: letter_to_client
  filename: L${ clientmessage.textoption }_${ format_date(today(), format='yyyy-MM-dd')}
  docx template file: Letterhead-client.docx
  valid formats: 
    - pdf
    - docx
  variable name: letter_to_client
---
attachment: 
  name: letter_to_pbadvocate
  filename: L${ clientmessage.textoption }_${ format_date(today(), format='yyyy-MM-dd')}
  docx template file: Letterhead-pbadvocate.docx
  valid formats: 
    - pdf
    - docx
  variable name: letter_to_pbadvocate
---